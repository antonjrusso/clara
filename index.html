<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Clara by edf-hpc</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Clara</h1>
      <h2 class="project-tagline">Cluster Administration tools</h2>
      <a href="https://github.com/edf-hpc/clara" class="btn">View on GitHub</a>
      <a href="https://github.com/edf-hpc/clara/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/edf-hpc/clara/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="whats-clara" class="anchor" href="#whats-clara" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>What's Clara?</h1>

<p>Clara is a set of cluster administration tools created to help in the
installation and maintenance of clusters at EDF.</p>

<p>The different tools are written as independent plugins that can be added,
removed and modified independently.</p>

<p>Clara is distributed under the CeCILL-C Free Software License Agreement version
1.0. You can find more information about the CeCILL licenses at
<a href="http://www.cecill.info/index.en.html">http://www.cecill.info/index.en.html</a>.</p>

<h1>
<a id="obtaining-building-and-installing-clara" class="anchor" href="#obtaining-building-and-installing-clara" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Obtaining, building and installing Clara</h1>

<p>Clara's code is available at GitHub <a href="https://github.com/edf-hpc/clara">https://github.com/edf-hpc/clara</a>.
You can obtain a copy using <em>git</em>:</p>

<pre><code>$ git clone https://github.com/edf-hpc/clara.git
</code></pre>

<p>Clara is developed and probably only useful in a Debian or a Debian derivative
system. The debian packaging files are included, so you only need to build
a Debian package and install it.
Before building the package, you will need to install the following packages:</p>

<pre><code># apt-get install debhelper python-all python-setuptools pandoc bash-completion dpkg-dev
</code></pre>

<p>And then from the root directory of your git copy, you can run:</p>

<pre><code># dpkg-buildpackage
</code></pre>

<p>This will create a package you can install with dpkg.</p>

<p>If you're not using Debian, Clara provides a setuptools script for its installation.
Just run:</p>

<pre><code># python setup.py install
</code></pre>

<p>If you chose to install manually, you also will need to install the runtime
dependencies. The dependencies common to all plugins are:
<a href="http://www.python.org">python</a>, <a href="http://docopt.org/">docopt</a> and <a href="http://cea-hpc.github.io/clustershell/">clustershell</a>.</p>

<p>The remaining dependencies, listed by plugin, are:</p>

<ul>
<li><p>slurm: <a href="http://slurm.schedmd.com/">slurm-client</a></p></li>
<li><p>repo: <a href="http://mirrorer.alioth.debian.org/">reprepro</a>, <a href="https://www.gnupg.org/">gnupg</a>, <a href="https://packages.debian.org/sid/debmirror">debmirror</a></p></li>
<li><p>impi: <a href="http://fping.org/">fping</a>, <a href="http://sourceforge.net/projects/ipmitool/">ipmitool</a>, <a href="https://sourceforge.net/projects/sshpass/">sshpass</a></p></li>
<li><p>images: <a href="https://packages.debian.org/sid/debootstrap">debootstrap</a>, <a href="http://squashfs.sourceforge.net/">squashfs-tools</a></p></li>
<li><p>p2p: <a href="http://mktorrent.sourceforge.net/">mktorrent</a></p></li>
<li><p>build: <a href="https://wiki.debian.org/cowbuilder">cowbuilder</a></p></li>
</ul>

<h1>
<a id="getting-started" class="anchor" href="#getting-started" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Getting started</h1>

<p>Clara itself is not a tool, but rather provides a common interface to several
tools. To see the list of available tools, just type <code>clara</code> like in the following
example.</p>

<pre><code># clara

Usage: clara [-d | -dd] [options] &lt;plugin&gt; [&lt;args&gt;...]
       clara help &lt;plugin&gt;
       clara [--version]
       clara [--help]

Options:
    -d                 Enable debug output
    -dd                Enable debug output for third party applications
    --config=&lt;file&gt;    Provide a configuration file

Clara provides the following plugins:
   repo     Creates, updates and synchronizes local Debian repositories.
   ipmi     Manages and get the status from the nodes of a cluster.
   slurm    Performs tasks using SLURM's controller.
   images   Creates and updates the images of installation of a cluster.
   p2p      Makes torrent images and seeds them via BitTorrent.
   enc      Interact with encrypted files using configurable methods.
   build    Builds Debian packages.

See 'clara help &lt;plugin&gt;' for detailed help on a plugin
and 'clara &lt;plugin&gt; --help' for a quick list of options of a plugin.
</code></pre>

<p>Then to use the tool <em>repo</em>, just type <code>clara repo</code> and it'll show you the
options of <em>repo</em>:</p>

<pre><code># clara repo
Usage:
    clara repo key
    clara repo init &lt;dist&gt;
    clara repo sync (all|&lt;dist&gt; [&lt;suites&gt;...])
    clara repo add &lt;dist&gt; &lt;file&gt;... [--reprepro-flags="list of flags"...]
    clara repo del &lt;dist&gt; &lt;name&gt;...
    clara repo list &lt;dist&gt;
    clara repo -h | --help | help
</code></pre>

<p>You can check quickly the help of the tool <em>repo</em> invoking the manpage:
<code>man clara-repo</code> or just typing <code>clara help repo</code>.</p>

<h1>
<a id="configuration-file" class="anchor" href="#configuration-file" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Configuration file</h1>

<p>The configuration file of Clara is installed at <code>/etc/clara/config.ini</code> and it
is a simple text file using the <a href="http://en.wikipedia.org/wiki/INI_file">INI file format</a>.
This file has a basic structure composed of sections, properties, and values.
For example, a portion from the Clara's configuration file is copied:</p>

<pre><code>[common]
; File: Contains the usernames and passwords needed by the scripts
master_passwd_file=/srv/clara/data/master_pwd
; List: Posible distributions to be used if we're using multi-distro
allowed_distributions=calibre8,calibre9
; String: Name of your Debian derivative by default
default_distribution=calibre8
; String: Name of the team or departament maintaining the repository
; It's only used by reprepro
origin=HPC

[repo]
; String: Name of your cluster or project.
clustername=cluster
; String: Version number of your debian derivative
version=8.0.0
; Path: Directory containing all the configuration files for the local repository
repo_dir=/srv/clara/calibre8/local-mirror
</code></pre>

<p>The lines starting with a semi-colon are commentaries and they're ignored.</p>

<p><code>[common]</code> and <code>[repo]</code> indicate the begin of a section and its name.</p>

<p>The remaining lines contain properties. Every property has a name and a value,
delimited by an equals sign (=). The name appears to the left of the equals sign
and the value appears to the right. All properties listed after a section
declaration are associated with that section.</p>

<p>The section <code>[common]</code> is common to all the plugins and then every plugin
can add a section with the name of the plugin.</p>

<p>Sometimes, we want to add specific values for different distros and in that case
we'll need to add the name of the plugin, a hyphen <code>-</code> followed by the name of
the distribution. For example, if we want to add different configurations
values for the plugin <code>repo</code> for calibre8 and calibre9, we'll need to add them
under the sections <code>[repo-calibre8]</code> and <code>[repo-calibre9]</code>.</p>

<h1>
<a id="plugins" class="anchor" href="#plugins" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Plugins</h1>

<h2>
<a id="plugin-repo" class="anchor" href="#plugin-repo" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Plugin 'repo'</h2>

<p><em>clara repo</em> offers simple commands to create a local Debian repository with
reprepro and update, add and remove files from them. It also provides the
possibility of making mirror of remote Debian repositories locally.</p>

<h3>
<a id="sypnosis" class="anchor" href="#sypnosis" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Sypnosis</h3>

<pre><code>clara repo key
clara repo init &lt;dist&gt;
clara repo sync (all|&lt;dist&gt; [&lt;suites&gt;...])
clara repo add &lt;dist&gt; &lt;file&gt;... [--reprepro-flags="list of flags"...]
clara repo del &lt;dist&gt; &lt;name&gt;...
clara repo list &lt;dist&gt;
clara repo -h | --help | help
</code></pre>

<p>Options:</p>

<pre><code>&lt;file&gt; can be one or more *.deb binaries, *.changes files or *.dsc files.

&lt;name&gt; is the package to remove, if the package is a source name, it'll
remove all the associated binaries
</code></pre>

<h3>
<a id="options" class="anchor" href="#options" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Options</h3>

<pre><code>clara repo key
</code></pre>

<p>Install the secret GPG key to use in the repository.</p>

<pre><code>clara repo init &lt;dist&gt;
</code></pre>

<p>Create the initial configuration for reprepro for our local repository and makes
the first export.</p>

<pre><code>clara repo sync (all|&lt;dist&gt; [&lt;suites&gt;...])
</code></pre>

<p>Mirror locally a Debian suite. We can choose a single suite such as wheezy,
wheezy-backports, calibre8, etc; we can choose all the suites with the parameter
'all' or just all the suites used by a distribution.</p>

<pre><code>clara repo add &lt;dist&gt; &lt;file&gt;... [--reprepro-flags="list of flags"...]
</code></pre>

<p>Add packages to the local repository.
<code>&lt;file&gt;</code> can be one or more *.deb binaries, *.changes files or *.dsc files.
For the --reprepro-flags, check the documentation of reprepro.</p>

<pre><code>clara repo del &lt;dist&gt; &lt;name&gt;...
</code></pre>

<p>Remove package to the local repository.
<code>&lt;name&gt;</code> is the package to remove, if the package is a source name, it'll also
remove all the associated binaries.</p>

<pre><code>clara repo list &lt;dist&gt;
</code></pre>

<p>Lists all contents of the repository.</p>

<p>This distribution in  must be listed in the field "allowed_distributions"
from the section [common].</p>

<h3>
<a id="examples" class="anchor" href="#examples" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Examples</h3>

<p>To mirror locally all the suites from calibre8:</p>

<pre><code># clara repo sync calibre8
</code></pre>

<p>To mirror locally Debian backports for Wheezy:</p>

<pre><code># clara repo sync calibre8 wheezy-backports
</code></pre>

<p>To create a local repository and add packages to it:</p>

<pre><code># clara repo key
# clara repo init calibre8
# clara repo add calibre8 mypackage_1-2.dsc
</code></pre>

<h2>
<a id="plugin-ipmi" class="anchor" href="#plugin-ipmi" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Plugin 'ipmi'</h2>

<p><em>clara ipmi</em> offers a simplified interface of ipmitool, an utility for controlling
IPMI-enabled devices. The username and password needed by ipmitool are handled
automatically.</p>

<h3>
<a id="sypnosis-1" class="anchor" href="#sypnosis-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Sypnosis</h3>

<pre><code>clara ipmi connect [-jf] &lt;host&gt;
clara ipmi getmac &lt;hostlist&gt;
clara ipmi [--p=&lt;level&gt;] deconnect &lt;hostlist&gt;
clara ipmi [--p=&lt;level&gt;] (on|off|reboot) &lt;hostlist&gt;
clara ipmi [--p=&lt;level&gt;] status &lt;hostlist&gt;
clara ipmi [--p=&lt;level&gt;] setpwd &lt;hostlist&gt;
clara ipmi [--p=&lt;level&gt;] pxe &lt;hostlist&gt;
clara ipmi [--p=&lt;level&gt;] disk &lt;hostlist&gt;
clara ipmi [--p=&lt;level&gt;] ping &lt;hostlist&gt;
clara ipmi [--p=&lt;level&gt;] blink &lt;hostlist&gt;
clara ipmi [--p=&lt;level&gt;] immdhcp &lt;hostlist&gt;
clara ipmi [--p=&lt;level&gt;] bios &lt;hostlist&gt;
clara ipmi [--p=&lt;level&gt;] reset &lt;hostlist&gt;
clara ipmi [--p=&lt;level&gt;] sellist &lt;hostlist&gt;
clara ipmi [--p=&lt;level&gt;] selclear &lt;hostlist&gt;
clara ipmi [--p=&lt;level&gt;] ssh &lt;hostlist&gt; &lt;command&gt;
clara ipmi -h | --help

clara ipmi &lt;host&gt; connect [-jf]
clara ipmi &lt;hostlist&gt; getmac
clara ipmi [--p=&lt;level&gt;] &lt;hostlist&gt; deconnect
clara ipmi [--p=&lt;level&gt;] &lt;hostlist&gt; (on|off|reboot)
clara ipmi [--p=&lt;level&gt;] &lt;hostlist&gt; status
clara ipmi [--p=&lt;level&gt;] &lt;hostlist&gt; setpwd
clara ipmi [--p=&lt;level&gt;] &lt;hostlist&gt; pxe
clara ipmi [--p=&lt;level&gt;] &lt;hostlist&gt; disk
clara ipmi [--p=&lt;level&gt;] &lt;hostlist&gt; ping
clara ipmi [--p=&lt;level&gt;] &lt;hostlist&gt; blink
clara ipmi [--p=&lt;level&gt;] &lt;hostlist&gt; immdhcp
clara ipmi [--p=&lt;level&gt;] &lt;hostlist&gt; bios
clara ipmi [--p=&lt;level&gt;] &lt;hostlist&gt; reset
clara ipmi [--p=&lt;level&gt;] &lt;hostlist&gt; sellist
clara ipmi [--p=&lt;level&gt;] &lt;hostlist&gt; selclear
clara ipmi [--p=&lt;level&gt;] &lt;hostlist&gt; ssh &lt;command&gt;
</code></pre>

<h3>
<a id="options-1" class="anchor" href="#options-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Options</h3>

<pre><code>clara ipmi connect [-jf] &lt;host&gt;
</code></pre>

<p>Connect to IMM serial console, including video, keyboard and mouse controlling
The flag -j joins the connection and the flag -f forces it.</p>

<pre><code>clara ipmi deconnect &lt;host&gt;
</code></pre>

<p>Deconnect from a IMM serial console</p>

<pre><code>clara ipmi on &lt;hostlist&gt;
</code></pre>

<p>Power up chassis</p>

<pre><code>clara ipmi off &lt;hostlist&gt;
</code></pre>

<p>Power down chassis into soft off. WARNING: it does do a clean shutdown of the OS.</p>

<pre><code>clara ipmi reboot &lt;hostlist&gt;
</code></pre>

<p>This command will perform a hard reset</p>

<pre><code>clara ipmi status &lt;hostlist&gt;
</code></pre>

<p>Get target node power status using the IMM device</p>

<pre><code>clara ipmi setpwd &lt;hostlist&gt;
</code></pre>

<p>Set up IMM user id/password on a new device</p>

<pre><code>clara ipmi getmac &lt;hostlist&gt;
</code></pre>

<p>Get node MAC addresses using the IMM device</p>

<pre><code>clara ipmi pxe &lt;hostlist&gt;
</code></pre>

<p>Use IMM to perform a network boot on the next reboot</p>

<pre><code>clara ipmi disk &lt;hostlist&gt;
</code></pre>

<p>Use IMM to perform a disk boot on the next reboot</p>

<pre><code>clara ipmi ping &lt;hostlist&gt;
</code></pre>

<p>Use fping to check status of the machines</p>

<pre><code>clara ipmi blink &lt;hostlist&gt;
</code></pre>

<p>Make chassis blink to help on-site admins to identify the machine</p>

<pre><code>clara ipmi immdhcp &lt;hostlist&gt;
</code></pre>

<p>Set selected ipmi interfaces to grab an IP via DHCP</p>

<pre><code>clara ipmi bios &lt;hostlist&gt;
</code></pre>

<p>Make selected machines go directly into BIOS on next reboot</p>

<pre><code>clara ipmi sellist &lt;hostlist&gt;
</code></pre>

<p>Display the entire content of the System Event Log (SEL).</p>

<pre><code>clara ipmi selclear &lt;hostlist&gt;
</code></pre>

<p>Clear the contents of the System Event Log (SEL). It cannot be undone so be careful.</p>

<pre><code>clara ipmi reset &lt;hostlist&gt;
</code></pre>

<p>Reset the IMM device (cold reset)</p>

<pre><code>clara ipmi ssh &lt;hostlist&gt; &lt;command&gt;
</code></pre>

<p>Run a command through the SSH interface of the IMM</p>

<p>For the commands that allow to interact multiple nodes at the same time,
the command can be run in parallel using [--p=].
The parallelism to use by default can be set in the configuration file
in the [ipmi] section with the paramenter "parallel". This value is
overridden by the input from the command line.</p>

<h3>
<a id="examples-1" class="anchor" href="#examples-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Examples</h3>

<p>This command will ping all hosts nodes from node12 to n99:</p>

<pre><code># clara ipmi ping node[12-99]
</code></pre>

<p>To check the status from node13:</p>

<pre><code># clara ipmi status node13
</code></pre>

<p>Or also:</p>

<pre><code># clara ipmi node13 status
</code></pre>

<p>And you can check the status of all the nodes using parallelism:</p>

<pre><code># clara ipmi --p=16 status node[12-99]
</code></pre>

<h2>
<a id="plugin-slurm" class="anchor" href="#plugin-slurm" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Plugin 'slurm'</h2>

<p><em>clara slurm</em> provides a simplified interface to the most useful commands from
SLURM.</p>

<h3>
<a id="sypnosis-2" class="anchor" href="#sypnosis-2" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Sypnosis</h3>

<pre><code>clara slurm health &lt;nodeset&gt;
clara slurm resume &lt;nodeset&gt;
clara slurm drain [&lt;nodeset&gt;] [&lt;reason&gt;...]
clara slurm down [&lt;nodeset&gt;]
clara slurm &lt;cmd&gt; &lt;subject&gt; [&lt;op&gt;] [&lt;spec&gt;...]
clara slurm -h | --help
</code></pre>

<p>Options:
     is one of the following ones: show, create, update and delete.</p>

<pre><code>&lt;cmd&gt; is one of the following ones: job, node, steps, frontend,
partition, reservation, block and submp.
</code></pre>

<h3>
<a id="options-2" class="anchor" href="#options-2" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Options</h3>

<pre><code>clara slurm health &lt;nodeset&gt;
</code></pre>

<p>Show nodes' health</p>

<pre><code>clara slurm resume &lt;nodeset&gt;
</code></pre>

<p>Resume the nodes.</p>

<pre><code>clara slurm drain [&lt;nodeset&gt;] [&lt;reason&gt;...]
</code></pre>

<p>Shows drained nodes and reason why they have been drained, when used without arguments.
When it is given a nodeset, it drains the specified nodes.</p>

<pre><code>clara slurm down [&lt;nodeset&gt;]
</code></pre>

<p>Shows nodes down when used without arguments.
When it is given a nodeset, it puts down the specified nodes.</p>

<pre><code>clara slurm &lt;cmd&gt; &lt;subject&gt; [&lt;op&gt;] [&lt;spec&gt;...]
</code></pre>

<p>Simplified interface for scontrol.
Not all the  options are compatible with any <code>&lt;cmd&gt;</code> option but clara
will warn you of not allowed combinations.</p>

<h3>
<a id="examples-2" class="anchor" href="#examples-2" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Examples</h3>

<p>Put the nodes node[3-6] down</p>

<pre><code># clara slurm down node[3-6]
</code></pre>

<h2>
<a id="plugin-images" class="anchor" href="#plugin-images" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Plugin 'images'</h2>

<p><em>clara images</em> makes easy to create and update the images to boot the nodes of
a cluster.</p>

<h3>
<a id="sypnosis-3" class="anchor" href="#sypnosis-3" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Sypnosis</h3>

<pre><code>clara images create &lt;dist&gt; [&lt;image&gt;] [--keep-chroot-dir]
clara images unpack ( &lt;dist&gt; | --image=&lt;path&gt; )
clara images repack &lt;directory&gt; ( &lt;dist&gt; | --image=&lt;path&gt; )
clara images edit &lt;dist&gt; [&lt;image&gt;]
clara images initrd &lt;dist&gt; [--output=&lt;dirpath&gt;]
clara images -h | --help | help
</code></pre>

<p>Options:</p>

<pre><code>--image=&lt;path&gt;  Path to squashfs image.
</code></pre>

<h3>
<a id="options-3" class="anchor" href="#options-3" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Options</h3>

<pre><code>clara images create &lt;dist&gt; [&lt;image&gt;] [--keep-chroot-dir]
</code></pre>

<p>Create a new squashfs image to use as operating system on the cluster nodes.
By default it unpacks the default image but the user can provide the path to a
different file.
The option <code>--keep-chroot-dir</code> allows to create the chroot used to generate
the image. By default, this chroot directory is deleted.</p>

<pre><code>clara images unpack ( &lt;dist&gt; | --image=&lt;path&gt; )
</code></pre>

<p>Unpack the squashfs file. By default it unpacks the default image but the user
can provide the path to a different file.</p>

<pre><code>clara images repack &lt;directory&gt; ( &lt;dist&gt; | --image=&lt;path&gt; )
</code></pre>

<p>Repack the squashfs file providing the image.  By default it repacks and replace
the default image but the user can choose to provide a path to save it with a
different name.</p>

<pre><code>clara images edit &lt;dist&gt; [&lt;image&gt;]
</code></pre>

<p>Unpacks the image for editing, spawns a bash to make the changes and repacks
the image again after. By default it edits the default image but the user can
provide the path to a different image.</p>

<pre><code>clara images initrd &lt;dist&gt; [--output=&lt;dirpath&gt;]
</code></pre>

<p>Create a new initrd image to boot the cluster nodes.
The user can use the <code>--output</code> option to select a directory different to the
default one to save the generated initrd.</p>

<p>This distribution in  must be listed in the field "allowed_distributions"
from the section [common].</p>

<h3>
<a id="examples-3" class="anchor" href="#examples-3" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Examples</h3>

<p>To create a image for calibre8 and store it in <code>/tmp/c8.squashfs</code></p>

<pre><code># clara images create calibre8 /tmp/c8.squashfs
</code></pre>

<p>To edit the default distribution image</p>

<pre><code># clara images edit calibre8
</code></pre>

<p>To create a initrd for the default distribution image:</p>

<pre><code> # clara images initrd calibre8
</code></pre>

<h2>
<a id="plugin-p2p" class="anchor" href="#plugin-p2p" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Plugin 'p2p'</h2>

<p><em>clara p2p</em> eases creating torrent files for the cluster installation images
and controlling the seeders and trackers of the cluster to see the new torrent
file.</p>

<h3>
<a id="synopsis" class="anchor" href="#synopsis" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Synopsis</h3>

<pre><code>clara p2p status
clara p2p restart
clara p2p mktorrent &lt;dist&gt; [--image=&lt;path&gt;]
clara p2p -h | --help | help
</code></pre>

<h3>
<a id="options-4" class="anchor" href="#options-4" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Options</h3>

<pre><code>clara p2p status
</code></pre>

<p>Check the status of the BitTorrent trackers and seeders</p>

<pre><code>clara p2p restart
</code></pre>

<p>Restart the BitTorrent trackers and seeders</p>

<pre><code>clara p2p mktorrent &lt;dist&gt; [--image=&lt;path&gt;]
</code></pre>

<p>Create a new torrent file for the squashfs image and restart trackers
and initial seeders. The distribution in  must be listed in the field
"allowed_distributions" from the section [common].</p>

<h3>
<a id="examples-4" class="anchor" href="#examples-4" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Examples</h3>

<p>To create a torrent file for the images placed at <code>/tmp/calibre9.squashfs</code></p>

<pre><code># clara p2p mktorrent calibre9 --image=/tmp/calibre9.squashfs
</code></pre>

<h2>
<a id="plugin-enc" class="anchor" href="#plugin-enc" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Plugin 'enc'</h2>

<p><em>clara enc</em> shows, edits and creates encrypted files using configurable methods
to get the encryption key and encrypt/decrypt files.</p>

<h3>
<a id="synopsis-1" class="anchor" href="#synopsis-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Synopsis</h3>

<pre><code>clara enc show &lt;file&gt;
clara enc edit &lt;file&gt;
clara enc encode &lt;file&gt;
clara enc decode &lt;file&gt;
clara enc -h | --help | help
</code></pre>

<h3>
<a id="options-5" class="anchor" href="#options-5" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Options</h3>

<pre><code>clara enc show &lt;file&gt;
</code></pre>

<p>Shows a encoded filed in plain in the terminal. It'll use <code>$PAGER</code> to show it.</p>

<pre><code>clara enc edit &lt;file&gt;
</code></pre>

<p>Allows to create or edit a file that will be automatically encoded after closing
the editor and the copy in plain text will be erased. It'll use <code>$EDITOR</code> to edit it.</p>

<pre><code>clara enc encode &lt;file&gt;
</code></pre>

<p>It will encode a file. The resulting file will have the same name than
the original appendix the suffix ".enc"</p>

<pre><code>clara enc decode &lt;file&gt;
</code></pre>

<p>It will decode a encrypted file. The encrypted file must have the suffix ".enc"
in its name. The resulting file will have the same name than the original without
the suffix ".enc"</p>

<h3>
<a id="examples-5" class="anchor" href="#examples-5" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Examples</h3>

<p>To create an encrypted file in <code>/data/mydata.enc</code>:</p>

<pre><code># clara enc edit /data/mydata.enc
</code></pre>

<p>To see quickly the contents of an encrypted file:</p>

<pre><code># clara enc show this_is_my_file.enc
</code></pre>

<p>To create a plain text copy of an encrypted file:</p>

<pre><code> # clara en decode this_is_my_file.enc
</code></pre>

<p>This will create an unencrypted file "this_is_my_file"</p>

<h2>
<a id="plugin-build" class="anchor" href="#plugin-build" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Plugin 'build'</h2>

<p><em>clara build</em> allows to build packages for any of the custom distributions
and also rebuild a package that's already in the local repository of another
custom distribution.
This plugin requires <em>cowbuilder</em> installed and configured.</p>

<h3>
<a id="synopsis-2" class="anchor" href="#synopsis-2" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Synopsis</h3>

<pre><code>clara build source &lt;dist&gt; &lt;dsc_file&gt;
clara build repo &lt;dist&gt; &lt;origin_dist&gt; &lt;package_name&gt;
clara build -h | --help | help
</code></pre>

<h3>
<a id="options-6" class="anchor" href="#options-6" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Options</h3>

<pre><code>clara build source &lt;dist&gt; &lt;dsc_file&gt;
</code></pre>

<p>Build a source package targetting the distro indicated.</p>

<pre><code>clara build repo &lt;dist&gt; &lt;origin_dist&gt; &lt;package_name&gt;
</code></pre>

<p>Rebuilds a package from the local repository of the "origin_dist" for the distro
indicated. The repository must contain the source package of the package we want
to rebuild.</p>

<h3>
<a id="examples-6" class="anchor" href="#examples-6" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Examples</h3>

<p>To build the source package of calibre-hpc for calibre8 that is at /tmp/calibre-hpc_1.2.dsc</p>

<pre><code># clara build calibre8 /tmp/calibre-hpc_1.2.dsc
</code></pre>

<p>To rebuild the same package for calibre9 using the package in the local repository
of calibre8:</p>

<pre><code># clara build calibre8 calibre9 calibre-hpc
</code></pre>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/edf-hpc/clara">Clara</a> is maintained by <a href="https://github.com/edf-hpc">edf-hpc</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
